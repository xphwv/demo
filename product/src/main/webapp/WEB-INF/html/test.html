<!DOCTYPE html>
<head>
<meta charset="utf-8">
<title>ECharts</title>
</head>
<body>
	<!-- 为ECharts准备一个具备大小（宽高）的Dom -->
	<div id="main" style="height: 500px"></div>
	<!-- ECharts单文件引入 -->
	<script src="http://echarts.baidu.com/build/dist/echarts.js"></script>
	<script src="http://libs.baidu.com/jquery/1.9.0/jquery.js"></script>
	<script type="text/javascript">
		// 路径配置
		require.config({
			paths : {
				echarts : 'http://echarts.baidu.com/build/dist',
				theme : 'http://echarts.baidu.com/doc/example/theme'
			}
		});
	</script>
	<select id="theme-select"></select>
	
<script type="text/javascript">
	// 使用// 加载线图就加载line模块，按需加载
	require([ 'echarts', 'echarts/chart/line'], function(ec) {
		// 图表实例化------------------
		var myChart = ec.init(document.getElementById('main'));
		// loading
		myChart.showLoading({
			text : '正在努力的读取数据中...', //loading话术
		});
		//初始化基本配置信息
		option = {
			tooltip : {
				trigger : 'axis'
			},
			legend : {
				data : []
			},
			toolbox : {
				show : true,
				feature : {
					mark : {
						show : true
					},
					dataZoom : {
						show : true
					},
					dataView : {
						show : true
					},
					magicType : {
						show : true,
						type : []
					},
					restore : {
						show : true
					},
					saveAsImage : {
						show : true
					}
				}
			},
			calculable : true,
			dataZoom : {
				show : true,
				realtime : true,
				start : 20,
				end : 80
			},
			xAxis : [],
			yAxis : [],
			series : []
		};
		// ---------------------------自行实现代码-----------------------------------------------
		//形状
		var _type = "line";// 图表类型，折线图line、散点图scatter、柱状图bar、饼图pie、雷达图radar
		//图列标识+
		var _name = [];
		//后台获取基本数据  或者用ajax 同步执行
		$.getJSON("/echarts/data", function(json) {
			console.log(json);
			//下面直接用json即可
			var _datas = $(json);
			_datas.each(function(i, o) {
				var _oName = o.name;
				_name[i] = _oName;

				option.series.push({
					name : _oName, // 系列名称
					type : _type,
					smooth:true,
		            itemStyle: {normal: {areaStyle: {type: 'default'}}},
					data : o.data
				});
			});
			//图例标识
			option.legend.data = _name;
			//时间轴固定数据，也可以从后台获取
			var _x = {
				type : 'category',
				boundaryGap : false,
				data : _datas[0].time
			}
			option.xAxis.push(_x);

			// loading隐藏
			myChart.hideLoading();
			//填充图型
			myChart.setOption(option);
		});

		//一般不需要使用
		// 图表清空
		// myChart.clear();
		// 图表释放
		// myChart.dispose();
	
	
	
	function needMap() {
	    var href = location.href;
	    return href.indexOf('map') != -1
	           || href.indexOf('mix3') != -1
	           || href.indexOf('mix5') != -1
	           || href.indexOf('dataRange') != -1;

	}
	var enVersion = location.hash.indexOf('-en') != -1;
	var hash = location.hash.replace('-en','');
	hash = hash.replace('#','') || (needMap() ? 'default' : 'macarons');
	hash += enVersion ? '-en' : '';
	var themeSelector = $('#theme-select');
	if (themeSelector) {
	    themeSelector.html(
	        '<option selected="true" name="macarons">macarons</option>'
	        + '<option name="infographic">infographic</option>'
	        + '<option name="shine">shine</option>'
	        + '<option name="dark">dark</option>'
	        + '<option name="blue">blue</option>'
	        + '<option name="green">green</option>'
	        + '<option name="red">red</option>'
	        + '<option name="gray">gray</option>'
	        + '<option name="helianthus">helianthus</option>'
	        + '<option name="default">default</option>'
	    );
	    $(themeSelector).on('change', function(){
	        selectChange($(this).val());
	    });
	    function selectChange(value){
	        var theme = value;
	        myChart.showLoading();
	        $(themeSelector).val(theme);
	        if (theme != 'default') {
	            window.location.hash = value + (enVersion ? '-en' : '');
	            require(['theme/' + theme], function(tarTheme){
	                curTheme = tarTheme;
	                setTimeout(refreshTheme, 500);
	            })
	        }
	        else {
	            window.location.hash = enVersion ? '-en' : '';
	            curTheme = {};
	            setTimeout(refreshTheme, 500);
	        }
	    }
	    function refreshTheme(){
	    	myChart.hideLoading();
	        myChart.setTheme(curTheme);
	    }
	    if ($(themeSelector).val(hash.replace('-en', '')).val() != hash.replace('-en', '')) {
	        $(themeSelector).val('macarons');
	        hash = 'macarons' + enVersion ? '-en' : '';
	        window.location.hash = hash;
	    }
	}
	});
</script>
</body>
</html>